# 英语听力训练应用配置示例
# 将此文件复制为 .env.local 并填入实际值
# 
# 🔒 安全警告:
# - 请勿将 .env.local 文件提交到 Git 仓库
# - 所有包含真实密钥的文件都应保持在 .gitignore 中
# - 定期轮换敏感密钥 (JWT_SECRET, CEREBRAS_API_KEY, DB_PASSWORD 等)
# - 生产环境请使用强密码和随机生成的密钥

# ==========================================
# 应用基础配置
# ==========================================
NODE_ENV=development
PORT=3000
HOST=localhost

# 应用 URL 和密钥配置 (生产环境必填)
NEXT_PUBLIC_APP_URL=https://yourdomain.com
APP_BASE_URL=http://localhost:3000
JWT_SECRET=your-jwt-secret-here

# ==========================================
# 数据库连接配置 (生产环境)
# ==========================================
# 数据库类型: sqlite | postgresql | mysql
DATABASE_TYPE=sqlite

# 生产环境数据库连接 (选择其一)
# PostgreSQL (推荐生产环境):
DATABASE_URL=postgresql://username:password@localhost:5432/listening_app
# MySQL (备选):
# DATABASE_URL=mysql://username:password@localhost:3306/listening_app

# SQLite 配置 (开发环境默认)
DATABASE_PATH=data/app.db
DB_TIMEOUT=10000
DB_JOURNAL_MODE=WAL
DB_SYNCHRONOUS=NORMAL
DB_CACHE_SIZE=2000
DB_MMAP_SIZE=268435456
DB_FOREIGN_KEYS=true

# 数据库服务器配置 (Docker/生产部署)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=listening_app
DB_USER=postgres
DB_PASSWORD=your-postgres-password
DB_ROOT_PASSWORD=your-mysql-root-password

# ==========================================
# Cerebras AI API 配置
# ==========================================
CEREBRAS_API_KEY=csk-your-api-key-here
CEREBRAS_BASE_URL=https://api.cerebras.ai
AI_TIMEOUT=30000
AI_MAX_RETRIES=3
AI_DEFAULT_MODEL=llama3.1-8b

# ==========================================
# TTS 配置 (仅 Kokoro TTS)
# ==========================================
# TTS 模式: local | disabled
TTS_MODE=local

# Kokoro TTS API 配置 (生产环境可独立部署)
KOKORO_API_URL=http://localhost:8080/tts
KOKORO_DEVICE=auto  # auto/cuda/metal/cpu

# 本地 Kokoro TTS 配置
ENABLE_TTS=true
TTS_PYTHON_PATH=kokoro-local/venv/bin/python
TTS_VENV_PATH=kokoro-local/venv
TTS_TIMEOUT=30000
TTS_MAX_CONCURRENT=1
TTS_MAX_RESTARTS=3
TTS_RESTART_COOLDOWN=5000

# GPU/CUDA 支持配置 (生产服务器)
CUDA_VISIBLE_DEVICES=0
PYTORCH_ENABLE_MPS_FALLBACK=1

# ==========================================
# 存储路径配置
# ==========================================
# 数据存储路径
DATA_PATH=./data
STORAGE_PATH=./storage
UPLOAD_DIR=/data/listening-app/uploads

# 音频文件存储路径
AUDIO_PATH=./public/audio
PUBLIC_AUDIO_URL=/audio

# 日志文件路径
LOGS_PATH=./logs

# ==========================================
# 安全和管理配置
# ==========================================
# 默认管理员账号配置 (数据库初始化时创建)
ADMIN_EMAIL=admin@listeningtrain.com
ADMIN_PASSWORD=Admin123456
ADMIN_NAME=System Administrator

# (已在上方配置)

# 安全设置
CORS_ORIGINS=http://localhost:3000,http://localhost:3001
RATE_LIMIT=60

# ==========================================
# 功能开关
# ==========================================
ENABLE_ANALYTICS=false
ENABLE_CACHING=true
ENABLE_LOGGING=true
ENABLE_METRICS=true
ENABLE_HEALTH_CHECK=true

# 管理员演示数据（仅用于截图/演示；不要用于真实效果结论）
# - 设为 1 时，管理员后台“效果统计”会显示模拟数据（默认 50 人、约 80% 提升）
ADMIN_DEMO_DATA=0

# ==========================================
# 新闻增强功能 (可选)
# ==========================================
# Exa API 密钥 (用于新闻增强模式的实时搜索)
# 获取地址: https://exa.ai
EXA_API_KEY=your-exa-api-key-here

# RSS 抓取代理配置 (可选)
# 1) 显式指定代理（推荐，最清晰）:
# RSS_PROXY_URL=http://127.0.0.1:10808
# 2) 或者启用系统代理环境变量 (HTTPS_PROXY/HTTP_PROXY):
# RSS_USE_SYSTEM_PROXY=false

# ==========================================
# 缓存配置 (可选)
# ==========================================
REDIS_URL=redis://localhost:6379
CACHE_TTL=3600

# ==========================================
# Docker 部署配置
# ==========================================
# 容器健康检查
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s

# 数据卷挂载路径 (生产环境)
DOCKER_DATA_PATH=/app/data
DOCKER_AUDIO_PATH=/app/public/audio
DOCKER_LOGS_PATH=/app/logs
